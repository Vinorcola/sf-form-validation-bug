{% extends 'base.html.twig' %}



{% block body %}
    <h1>Mapping</h1>

    {{ form_start(form) }}
        <h2>Contexts</h2>

        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Context</th>
                    <th style="width: 50%">Column</th>
                </tr>
            </thead>
            <tbody>
                {% for context in form.contextMapping %}
                    <tr>
                        <td>{{ context.vars.data.title }}</td>
                        <td>
                            {{ form_errors(context) }}
                            {{ form_widget(context) }}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>Filters</h2>

        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Filter</th>
                    <th style="width: 50%">Column</th>
                </tr>
            </thead>
            <tbody>
                {% for filter in form.filterMapping %}
                    <tr>
                        <td>{{ filter.vars.data.title }}</td>
                        <td>
                            {{ form_widget(filter) }}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        {{ form_widget(form) }}
        <div class="button-group">
            <button type="submit" class="btn btn-primary">Submit</button>
        </div>
    {{ form_end(form) }}
{% endblock %}

{% block stylesheets %}
    <style>
        .form-group { margin: 0 }
    </style>
{% endblock %}

{% block javascripts %}
    <script>

        // We alter one of the list to trigger an invalid value error from a ChoiceType.
        var list = document.getElementById("{{ form.filterMapping.2.columnName.vars.id }}");
        list.options[1].value = "unknown";
        list.options[1].selected = true;

    </script>
{% endblock %}
